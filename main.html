<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="animation.css">
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
  />
<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<meta charset="UTF-8">
<body">


<div class = "game"> 

      <div class = "split left_image" id = "left_image" style="background-size: cover;
      background-repeat: no-repeat;
      background-position: center;">
          <p class = "term-keyword__keyword" id = "leftName">Name of the anime</p>
          <p class = "has" id = "anim-body ">is positioned at rank</p>
          <p class = "term-ranking__ranking" id = "leftRank">rank</p>
          <p class = "high_score" id = "anim-body ">High Score: 0</p>

    </div>


      <div class = "split right_image" id = "right_image" style="background-size: cover;
      background-repeat: no-repeat;
      background-position: center;">
      
      <p class = "term-keyword__keyword" id = "rightName">Name of the anime</p>
      <p class = "has" id = "anim-body ">is positioned at rank</p>
      <button class = "higher button" onclick="slideImage()" id = animateBtn1 >Higher</button>
      <button class = "lower button" id="animateBtn" class="btn btn-primary">Lower</button>
      <p class = "high_score" id = "anim-body ">High Score: 0</p>
          <p class = "current_score" id = "anim-head">Score: 0</p>

  </div>
</div>


<script>
      window.onload = function(){
        userAction();
      };
      const userAction = async () => {
      const numberOfAnimes = 4
      const listArray = [...Array(5).keys()];
      console.log(listArray);
      const response = await fetch('https://cors-anywhere.herokuapp.com/api.myanimelist.net/v2/anime/ranking?ranking_type=all&limit=4', {
        method:'get',
        headers: {
            'X-MAL-CLIENT-ID': '3943b48f057b523f7826f85fa3e6401d',
        }
        }) ;
      
      const myJson = await response.text(); //extract JSON from the http response
      console.log(myJson);
      const array = JSON.parse(myJson);
      console.log(array);
      firstAnime = Math.floor(Math.random() * numberOfAnimes);
      secondAnime = Math.floor(Math.random() * numberOfAnimes);
      left_anime = array["data"][firstAnime];
      right_anime = array["data"][secondAnime];
      
      left_img = left_anime['node']['main_picture']['large']
      right_img =  right_anime['node']['main_picture']['large']
      console.log(left_img,right_img);
      console.log(left_anime['node']['title']);
      leftName = left_anime['node']['title'];
      leftRank = left_anime['ranking']['rank'];


      rightName = right_anime['node']['title'];
      rightRank = right_anime['ranking']['rank'];



      document.getElementById("leftName").innerHTML = `${leftName}`;
      document.getElementById("leftRank").innerHTML = `${leftRank}`;

      document.getElementById("rightName").innerHTML = `${rightName}`;

      document.getElementById("left_image").style.backgroundImage = `url(${left_img})`;
      document.getElementById("right_image").style.backgroundImage = `url(${right_img})`;



      // do something with myJson 
    };

    

    $(function(){
      $('#animateBtn').click(function(){
        animate('#left_image', 'animate__fadeOutLeft');
        slideImage();
        return false;
      });

      $('#animateBtn2').click(function(){
        animate('header', 'slideOutUp');
        setTimeout(function(){
          $('header').css('visibility','hidden');
        }, 1000);
        return false;
      });

      // Animate
      function animate(element, animation){
        $(element).addClass('animate__animated '+animation);
        var wait = setTimeout(function(){
          $(element).removeClass('animate__animated '+animation);
        }, 1000);
      }
    })
    function slideImage() {
      let id = null;
      const elem = document.getElementById("right_image");  
      let pos = 0;
      clearInterval(id);
      id = setInterval(frame, 0.5);
      
      function frame() {
        if (pos == screen.width/2) {
          clearInterval(id);
        } else {
          
          pos += 6; 
          elem.style.right = pos + "px"; 
        }
      }

    }

</script>



</body>

</html>
